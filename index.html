<!DOCTYPE html>
<html lang="sq">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no, viewport-fit=cover">
    <title>Sistemi i Rezervimit të Hotelit</title>
    <style>
        :root {
            --primary-color: #4361ee;
            --primary-light: #4895ef;
            --primary-dark: #3f37c9;
            --secondary-color: #560bad;
            --dopio-color: #ef476f;
            --triple-color: #06d6a0;
            --suite-color: #8338ec;
            --available-color: #d8f3dc;
            --booked-color: #ffccd5;
            --pending-color: #fff3b0;
            --success-color: #06d6a0;
            --warning-color: #ffbe0b;
            --error-color: #ef476f;
            --text-dark: #2b2d42;
            --text-medium: #6c757d;
            --text-light: #adb5bd;
            --background-light: #f8f9fa;
            --background-white: #ffffff;
            --shadow-sm: 0 2px 4px rgba(0, 0, 0, 0.05);
            --shadow-md: 0 4px 6px rgba(0, 0, 0, 0.07);
            --shadow-lg: 0 10px 15px rgba(0, 0, 0, 0.1);
            --border-radius-sm: 0.375rem;
            --border-radius-md: 0.75rem;
            --border-radius-lg: 1rem;
            --border-radius-xl: 1.5rem;
            --border-radius-full: 9999px;
            --spacing-xs: 0.25rem;
            --spacing-sm: 0.5rem;
            --spacing-md: 1rem;
            --spacing-lg: 1.5rem;
            --spacing-xl: 2rem;
            --font-size-xs: 0.75rem;
            --font-size-sm: 0.875rem;
            --font-size-md: 1rem;
            --font-size-lg: 1.25rem;
            --font-size-xl: 1.5rem;
            --font-size-2xl: 2rem;
        }

        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
            font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, Helvetica, Arial, sans-serif;
            -webkit-tap-highlight-color: transparent;
        }

        body {
            background-color: var(--background-light);
            color: var(--text-dark);
            padding-bottom: env(safe-area-inset-bottom);
        }

        /* Header Styles */
        .header {
            background: linear-gradient(to right, var(--primary-color), var(--secondary-color));
            color: white;
            padding: var(--spacing-lg) var(--spacing-md);
            padding-top: calc(var(--spacing-lg) + env(safe-area-inset-top));
            position: sticky;
            top: 0;
            z-index: 20;
        }

        .header-title {
            font-size: var(--font-size-xl);
            font-weight: bold;
            margin-bottom: var(--spacing-sm);
        }

        .header-actions {
            display: flex;
            justify-content: space-between;
            align-items: center;
        }

        .header-stats {
            font-size: var(--font-size-xs);
            opacity: 0.85;
        }

        .btn-add {
            background-color: white;
            color: var(--primary-color);
            border: none;
            border-radius: var(--border-radius-full);
            padding: var(--spacing-xs) var(--spacing-md);
            font-size: var(--font-size-sm);
            font-weight: 600;
            cursor: pointer;
            transition: all 0.2s ease;
        }

        .btn-add:hover {
            transform: translateY(-1px);
            box-shadow: var(--shadow-md);
        }

        /* Date Navigation Styles */
        .date-nav {
            padding: var(--spacing-md);
            background-color: white;
            position: sticky;
            top: calc(5rem + env(safe-area-inset-top));
            z-index: 10;
            box-shadow: var(--shadow-sm);
        }

        .month-selector {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: var(--spacing-md);
        }

        .current-month {
            font-size: var(--font-size-lg);
            font-weight: 700;
        }

        .nav-buttons {
            display: flex;
            gap: var(--spacing-sm);
        }

        .nav-btn {
            width: 2rem;
            height: 2rem;
            background-color: white;
            border: 1px solid var(--primary-light);
            border-radius: var(--border-radius-full);
            display: flex;
            align-items: center;
            justify-content: center;
            color: var(--primary-color);
            cursor: pointer;
            transition: all 0.2s ease;
        }

        .nav-btn:hover {
            background-color: var(--primary-color);
            color: white;
        }

        /* Date Slider */
        .date-slider {
            display: flex;
            gap: var(--spacing-sm);
            overflow-x: auto;
            padding-bottom: var(--spacing-sm);
            scroll-snap-type: x mandatory;
            -webkit-overflow-scrolling: touch;
            scrollbar-width: none; /* Firefox */
        }

        .date-slider::-webkit-scrollbar {
            display: none; /* Chrome, Safari, Edge */
        }

        .date-item {
            display: flex;
            flex-direction: column;
            align-items: center;
            justify-content: center;
            width: 3rem;
            height: 4rem;
            flex-shrink: 0;
            border-radius: var(--border-radius-md);
            background-color: white;
            box-shadow: var(--shadow-sm);
            scroll-snap-align: start;
            transition: all 0.2s ease;
            position: relative;
            border: 1px solid transparent;
        }

        .date-item.active {
            background-color: var(--primary-color);
            color: white;
            box-shadow: var(--shadow-md);
        }

        .date-item::after {
            content: '';
            position: absolute;
            bottom: 5px;
            left: 50%;
            transform: translateX(-50%);
            width: 5px;
            height: 5px;
            border-radius: 50%;
            background-color: transparent;
        }

        .date-item.has-bookings::after {
            background-color: var(--dopio-color);
        }

        .date-item.active.has-bookings::after {
            background-color: white;
        }

        .date-weekday {
            font-size: var(--font-size-xs);
            font-weight: 500;
        }

        .date-day {
            font-size: var(--font-size-lg);
            font-weight: 700;
        }

        /* View Options */
        .view-options {
            display: flex;
            padding: var(--spacing-md);
            gap: var(--spacing-sm);
            background-color: white;
            margin-bottom: var(--spacing-md);
        }

        .view-tab {
            flex: 1;
            text-align: center;
            padding: var(--spacing-sm) var(--spacing-md);
            border-radius: var(--border-radius-md);
            font-weight: 600;
            font-size: var(--font-size-sm);
            cursor: pointer;
            transition: all 0.2s ease;
            color: var(--text-medium);
            border: 1px solid var(--text-light);
        }

        .view-tab.active {
            background-color: var(--primary-color);
            color: white;
            border-color: var(--primary-color);
        }

        /* Room List View */
        .room-list {
            padding: 0 var(--spacing-md);
            margin-bottom: var(--spacing-xl);
        }

        .room-category {
            margin-bottom: var(--spacing-lg);
        }

        .category-title {
            font-size: var(--font-size-sm);
            text-transform: uppercase;
            color: var(--text-medium);
            font-weight: 600;
            margin-bottom: var(--spacing-sm);
            letter-spacing: 0.05em;
            display: flex;
            align-items: center;
            gap: var(--spacing-sm);
        }

        .category-marker {
            width: 12px;
            height: 12px;
            border-radius: 50%;
        }

        .marker-dopio {
            background-color: var(--dopio-color);
        }

        .marker-triple {
            background-color: var(--triple-color);
        }

        .marker-suite {
            background-color: var(--suite-color);
        }

        .room-cards {
            display: grid;
            grid-template-columns: 1fr;
            gap: var(--spacing-sm);
        }

        .room-card {
            background-color: white;
            border-radius: var(--border-radius-md);
            box-shadow: var(--shadow-sm);
            padding: var(--spacing-md);
            position: relative;
            border-left: 3px solid transparent;
            transition: all 0.2s ease;
            cursor: pointer;
        }

        .room-card:active {
            transform: scale(0.98);
        }

        .room-card-dopio {
            border-left-color: var(--dopio-color);
        }

        .room-card-triple {
            border-left-color: var(--triple-color);
        }

        .room-card-suite {
            border-left-color: var(--suite-color);
        }

        .room-title {
            font-weight: 700;
            margin-bottom: var(--spacing-xs);
        }

        .room-status {
            position: absolute;
            top: var(--spacing-md);
            right: var(--spacing-md);
            font-size: var(--font-size-xs);
            font-weight: 600;
            padding: var(--spacing-xs) var(--spacing-sm);
            border-radius: var(--border-radius-full);
        }

        .room-status-available {
            background-color: var(--available-color);
            color: green;
        }

        .room-status-booked {
            background-color: var(--booked-color);
            color: #e63946;
        }

        .room-status-pending {
            background-color: var(--pending-color);
            color: #ee9b00;
        }

        .room-details {
            font-size: var(--font-size-xs);
            color: var(--text-medium);
            margin-bottom: var(--spacing-xs);
        }

        .room-client {
            font-size: var(--font-size-sm);
            font-weight: 500;
        }

        /* Stats Summary */
        .stats-summary {
            display: flex;
            padding: 0 var(--spacing-md);
            gap: var(--spacing-sm);
            overflow-x: auto;
            margin-bottom: var(--spacing-md);
            scroll-snap-type: x mandatory;
            -webkit-overflow-scrolling: touch;
            scrollbar-width: none;
        }

        .stats-summary::-webkit-scrollbar {
            display: none;
        }

        .stats-card {
            background-color: white;
            border-radius: var(--border-radius-md);
            padding: var(--spacing-md);
            min-width: 8rem;
            flex-shrink: 0;
            box-shadow: var(--shadow-sm);
            scroll-snap-align: start;
        }

        .stats-title {
            font-size: var(--font-size-xs);
            color: var(--text-medium);
            margin-bottom: var(--spacing-xs);
        }

        .stats-value {
            font-size: var(--font-size-lg);
            font-weight: 700;
        }

        .stats-fraction {
            font-size: var(--font-size-xs);
            color: var(--text-medium);
            font-weight: normal;
        }

        .progress-bar {
            width: 100%;
            height: 0.25rem;
            background-color: #e9ecef;
            border-radius: var(--border-radius-full);
            margin-top: var(--spacing-sm);
            overflow: hidden;
        }

        .progress-value {
            height: 100%;
            border-radius: var(--border-radius-full);
        }

        .progress-dopio {
            background-color: var(--dopio-color);
        }

        .progress-triple {
            background-color: var(--triple-color);
        }

        .progress-suite {
            background-color: var(--suite-color);
        }

        /* Daily Calendar View */
        .daily-calendar {
            padding: 0 var(--spacing-md);
            margin-bottom: var(--spacing-xl);
        }

        .time-slots {
            display: flex;
            flex-direction: column;
            gap: var(--spacing-sm);
        }

        .time-slot {
            background-color: white;
            border-radius: var(--border-radius-md);
            padding: var(--spacing-md);
            box-shadow: var(--shadow-sm);
            position: relative;
        }

        .time-slot-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: var(--spacing-md);
        }

        .time-slot-title {
            font-weight: 600;
        }

        .booking-entry {
            border-left: 3px solid transparent;
            padding-left: var(--spacing-sm);
            margin-bottom: var(--spacing-sm);
            display: flex;
            justify-content: space-between;
            align-items: center;
            padding: var(--spacing-sm);
            border-radius: var(--border-radius-sm);
            cursor: pointer;
            transition: all 0.15s ease;
        }

        .booking-entry:active {
            transform: scale(0.98);
        }

        .booking-entry-dopio {
            border-left-color: var(--dopio-color);
            background-color: rgba(239, 71, 111, 0.05);
        }

        .booking-entry-triple {
            border-left-color: var(--triple-color);
            background-color: rgba(6, 214, 160, 0.05);
        }

        .booking-entry-suite {
            border-left-color: var(--suite-color);
            background-color: rgba(131, 56, 236, 0.05);
        }

        .booking-info {
            flex: 1;
        }

        .booking-room {
            font-weight: 600;
            font-size: var(--font-size-sm);
        }

        .booking-client {
            font-size: var(--font-size-xs);
            color: var(--text-medium);
        }

        .booking-badge {
            font-size: var(--font-size-xs);
            padding: 3px var(--spacing-sm);
            border-radius: var(--border-radius-full);
            font-weight: 600;
        }

        .booking-badge-booked {
            background-color: var(--booked-color);
            color: #e63946;
        }

        .booking-badge-pending {
            background-color: var(--pending-color);
            color: #ee9b00;
        }

        /* Monthly Calendar View */
        .monthly-calendar {
            margin: 0 var(--spacing-md);
            overflow-x: auto;
            background-color: white;
            border-radius: var(--border-radius-md);
            box-shadow: var(--shadow-sm);
            margin-bottom: var(--spacing-xl);
            display: none;
        }

        .calendar-table {
            width: 100%;
            border-collapse: collapse;
            min-width: 700px;
        }

        .calendar-table th, .calendar-table td {
            border: 1px solid #e9ecef;
            padding: var(--spacing-sm);
            text-align: center;
        }

        .calendar-table th {
            background-color: #f8f9fa;
            font-weight: 600;
            position: sticky;
            top: 0;
            z-index: 10;
        }

        .calendar-cell {
            height: 48px;
            cursor: pointer;
            font-size: var(--font-size-xs);
            transition: all 0.2s ease;
            position: relative;
        }

        .cell-booked {
            background-color: var(--booked-color);
        }

        .cell-pending {
            background-color: var(--pending-color);
        }

        .cell-available {
            background-color: var(--available-color);
        }

        .cell-dopio::before {
            content: '';
            position: absolute;
            left: 0;
            top: 0;
            height: 100%;
            width: 3px;
            background-color: var(--dopio-color);
        }

        .cell-triple::before {
            content: '';
            position: absolute;
            left: 0;
            top: 0;
            height: 100%;
            width: 3px;
            background-color: var(--triple-color);
        }

        .cell-suite::before {
            content: '';
            position: absolute;
            left: 0;
            top: 0;
            height: 100%;
            width: 3px;
            background-color: var(--suite-color);
        }

        /* Bookings List */
        .bookings-list {
            padding: 0 var(--spacing-md);
            margin-bottom: var(--spacing-xl);
        }

        .bookings-section {
            margin-bottom: var(--spacing-lg);
        }

        .section-title {
            font-size: var(--font-size-xs);
            text-transform: uppercase;
            color: var(--text-medium);
            font-weight: 600;
            margin-bottom: var(--spacing-sm);
            letter-spacing: 0.05em;
        }

        .booking-card {
            background-color: white;
            border-radius: var(--border-radius-md);
            margin-bottom: var(--spacing-md);
            overflow: hidden;
            box-shadow: var(--shadow-sm);
            transition: all 0.2s ease;
        }

        .booking-card:active {
            transform: scale(0.98);
        }

        .booking-content {
            padding: var(--spacing-md);
            display: flex;
            flex-direction: column;
            gap: var(--spacing-sm);
        }

        .booking-header {
            display: flex;
            justify-content: space-between;
            align-items: flex-start;
        }

        .booking-room {
            font-weight: 700;
        }

        .booking-client {
            font-size: var(--font-size-sm);
            color: var(--text-medium);
        }

        .booking-date {
            font-size: var(--font-size-xs);
            color: var(--text-medium);
        }

        .booking-status {
            font-size: var(--font-size-xs);
            font-weight: 600;
            padding: var(--spacing-xs) var(--spacing-sm);
            border-radius: var(--border-radius-full);
        }

        .status-booked {
            background-color: #ffccd5;
            color: #e63946;
        }

        .status-pending {
            background-color: #fff3b0;
            color: #ee9b00;
        }

        .border-dopio {
            border-left: 4px solid var(--dopio-color);
        }

        .border-triple {
            border-left: 4px solid var(--triple-color);
        }

        .border-suite {
            border-left: 4px solid var(--suite-color);
        }

        /* Empty State */
        .empty-state {
            display: flex;
            flex-direction: column;
            align-items: center;
            justify-content: center;
            padding: var(--spacing-xl) var(--spacing-md);
            text-align: center;
        }

        .empty-icon {
            font-size: 3rem;
            color: var(--text-light);
            margin-bottom: var(--spacing-md);
        }

        .empty-title {
            font-size: var(--font-size-lg);
            font-weight: 600;
            margin-bottom: var(--spacing-sm);
            color: var(--text-medium);
        }

        .empty-description {
            font-size: var(--font-size-sm);
            color: var(--text-light);
            margin-bottom: var(--spacing-lg);
        }

        /* Floating Button */
        .floating-btn {
            position: fixed;
            bottom: calc(var(--spacing-lg) + env(safe-area-inset-bottom));
            right: var(--spacing-lg);
            width: 3.5rem;
            height: 3.5rem;
            border-radius: var(--border-radius-full);
            background: linear-gradient(to right, var(--primary-color), var(--secondary-color));
            color: white;
            display: flex;
            align-items: center;
            justify-content: center;
            border: none;
            box-shadow: var(--shadow-lg);
            cursor: pointer;
            transition: all 0.3s ease;
            z-index: 100;
        }

        .floating-btn:hover {
            transform: translateY(-3px) scale(1.05);
        }

        .floating-btn:active {
            transform: translateY(1px) scale(0.95);
        }

        /* Modal */
        .modal {
            display: none;
            position: fixed;
            z-index: 1000;
            left: 0;
            top: 0;
            width: 100%;
            height: 100%;
            background-color: rgba(0, 0, 0, 0.5);
            padding: 0 var(--spacing-md);
            overflow: auto;
            animation: fadeIn 0.3s ease;
        }

        .modal-content {
            background-color: white;
            margin: 10% auto;
            width: 100%;
            max-width: 28rem;
            border-radius: var(--border-radius-lg);
            box-shadow: var(--shadow-lg);
            overflow: hidden;
            animation: slideUp 0.3s ease;
        }

        .modal-header {
            background: linear-gradient(to right, var(--primary-color), var(--secondary-color));
            color: white;
            padding: var(--spacing-md);
        }

        .modal-title {
            font-size: var(--font-size-lg);
            font-weight: 700;
        }

        .modal-body {
            padding: var(--spacing-md);
        }

        .form-group {
            margin-bottom: var(--spacing-md);
        }

        .form-label {
            display: block;
            font-size: var(--font-size-sm);
            font-weight: 600;
            margin-bottom: var(--spacing-xs);
            color: var(--text-dark);
        }

        .form-control {
            width: 100%;
            padding: var(--spacing-md);
            border-radius: var(--border-radius-md);
            border: 1px solid var(--text-light);
            font-size: var(--font-size-md);
            transition: all 0.2s ease;
        }

        .form-control:focus {
            outline: none;
            border-color: var(--primary-color);
            box-shadow: 0 0 0 3px rgba(67, 97, 238, 0.15);
        }

        .modal-footer {
            padding: var(--spacing-md);
            display: flex;
            justify-content: flex-end;
            gap: var(--spacing-sm);
            border-top: 1px solid #e9ecef;
        }

        .btn {
            padding: var(--spacing-sm) var(--spacing-lg);
            border-radius: var(--border-radius-md);
            font-size: var(--font-size-sm);
            font-weight: 600;
            cursor: pointer;
            transition: all 0.2s ease;
            border: none;
        }

        .btn-secondary {
            background-color: #e9ecef;
            color: var(--text-dark);
        }

        .btn-primary {
            background: linear-gradient(to right, var(--primary-color), var(--primary-dark));
            color: white;
        }

        .btn-danger {
            background-color: var(--error-color);
            color: white;
        }

        .btn:hover {
            transform: translateY(-1px);
        }

        /* Details Panel */
        .booking-details-panel {
            background-color: white;
            padding: var(--spacing-md);
            border-radius: var(--border-radius-md);
            box-shadow: var(--shadow-sm);
            margin-bottom: var(--spacing-md);
        }

        .details-header {
            display: flex;
            justify-content: space-between;
            align-items: flex-start;
            margin-bottom: var(--spacing-md);
        }

        .details-title {
            font-size: var(--font-size-lg);
            font-weight: 700;
        }

        .details-status {
            font-size: var(--font-size-xs);
            font-weight: 600;
            padding: 3px var(--spacing-sm);
            border-radius: var(--border-radius-full);
        }

        .details-info {
            display: grid;
            grid-template-columns: auto 1fr;
            gap: var(--spacing-xs) var(--spacing-lg);
            margin-bottom: var(--spacing-lg);
        }

        .details-label {
            font-size: var(--font-size-sm);
            color: var(--text-medium);
        }

        .details-value {
            font-size: var(--font-size-sm);
            font-weight: 500;
        }

        .details-actions {
            display: flex;
            gap: var(--spacing-sm);
        }

        /* Loading Indicator */
        .loader {
            width: 100%;
            height: 100vh;
            display: flex;
            justify-content: center;
            align-items: center;
            position: fixed;
            background: rgba(255, 255, 255, 0.8);
            z-index: 9999;
            top: 0;
            left: 0;
        }

        .spinner {
            width: 40px;
            height: 40px;
            border: 4px solid rgba(0, 0, 0, 0.1);
            border-radius: 50%;
            border-top-color: var(--primary-color);
            animation: spin 1s ease-in-out infinite;
        }

        /* Toast Notification */
        .toast {
            position: fixed;
            bottom: calc(var(--spacing-lg) + 4rem + env(safe-area-inset-bottom));
            left: 50%;
            transform: translateX(-50%);
            background-color: var(--success-color);
            color: white;
            padding: var(--spacing-md) var(--spacing-lg);
            border-radius: var(--border-radius-full);
            font-weight: 500;
            box-shadow: var(--shadow-md);
            z-index: 9000;
            opacity: 0;
            transition: all 0.3s ease;
            pointer-events: none;
        }

        .toast.show {
            opacity: 1;
            transform: translate(-50%, -10px);
        }

        /* Tab Navigation */
        .tab-navigation {
            display: flex;
            background-color: white;
            padding: var(--spacing-sm);
            border-radius: var(--border-radius-full);
            margin: 0 var(--spacing-md);
            margin-bottom: var(--spacing-md);
            box-shadow: var(--shadow-sm);
        }

        .tab-button {
            flex: 1;
            text-align: center;
            padding: var(--spacing-sm) var(--spacing-md);
            border-radius: var(--border-radius-full);
            font-weight: 600;
            font-size: var(--font-size-sm);
            background: none;
            border: none;
            color: var(--text-medium);
            cursor: pointer;
            transition: all 0.2s ease;
        }

        .tab-button.active {
            background-color: var(--primary-color);
            color: white;
            box-shadow: var(--shadow-sm);
        }

        .view-container {
            display: none;
        }

        .view-container.active {
            display: block;
        }

        /* Responsive Styles */
        /* iPhone 13 Pro (Smaller iPhone) */
        @media screen and (max-width: 390px) {
            .date-item {
                width: 2.75rem;
                height: 3.75rem;
            }
            
            .date-day {
                font-size: var(--font-size-md);
            }
            
            .floating-btn {
                width: 3rem;
                height: 3rem;
            }
            
            .header-title {
                font-size: var(--font-size-lg);
            }
        }

        /* Tablets */
        @media screen and (min-width: 768px) {
            .header, .date-nav {
                padding-left: var(--spacing-xl);
                padding-right: var(--spacing-xl);
            }
            
            .tab-navigation, .stats-summary, .room-list, .daily-calendar, .bookings-list, .monthly-calendar {
                margin-left: var(--spacing-xl);
                margin-right: var(--spacing-xl);
            }
            
            .room-cards {
                grid-template-columns: repeat(2, 1fr);
            }
            
            .monthly-calendar {
                display: block;
            }
            
            .stats-card {
                flex: 1;
                min-width: 0;
            }
            
            .floating-btn {
                bottom: var(--spacing-xl);
                right: var(--spacing-xl);
            }
        }

        /* Laptops */
        @media screen and (min-width: 992px) {
            body {
                display: flex;
            }
            
            .sidebar {
                width: 250px;
                flex-shrink: 0;
                background-color: var(--primary-dark);
                height: 100vh;
                color: white;
                padding: var(--spacing-lg);
                position: sticky;
                top: 0;
                display: flex;
                flex-direction: column;
            }
            
            .main-content {
                flex: 1;
                max-height: 100vh;
                overflow: auto;
            }
            
            .room-cards {
                grid-template-columns: repeat(3, 1fr);
            }
            
            .floating-btn {
                display: none;
            }
            
            .desktop-actions {
                display: flex;
                gap: var(--spacing-sm);
                margin-bottom: var(--spacing-lg);
            }
            
            .main-layout {
                display: grid;
                grid-template-columns: 350px 1fr;
                gap: var(--spacing-md);
                margin: var(--spacing-md) var(--spacing-xl);
            }
            
            .main-panel, .side-panel {
                overflow-y: auto;
                max-height: calc(100vh - 10rem);
            }
            
            .side-panel {
                background-color: white;
                border-radius: var(--border-radius-md);
                padding: var(--spacing-md);
            }
        }

        /* Animations */
        @keyframes fadeIn {
            from { opacity: 0; }
            to { opacity: 1; }
        }

        @keyframes slideUp {
            from { transform: translateY(50px); opacity: 0; }
            to { transform: translateY(0); opacity: 1; }
        }

        @keyframes spin {
            to { transform: rotate(360deg); }
        }
    </style>
</head>
<body>
    <div class="main-content">
        <!-- Header -->
        <div class="header">
            <h1 class="header-title">Sistemi i Rezervimit të Hotelit</h1>
            <div class="header-actions">
                <div class="header-stats">15 rezervime aktive</div>
                <button class="btn-add" id="add-booking-btn">Shto</button>
            </div>
        </div>

        <!-- Date Navigation -->
        <div class="date-nav">
            <div class="month-selector">
                <div class="current-month" id="current-month">Prill 2025</div>
                <div class="nav-buttons">
                    <button class="nav-btn" id="prev-month">◀</button>
                    <button class="nav-btn" id="next-month">▶</button>
                </div>
            </div>

            <!-- Date Slider -->
            <div class="date-slider" id="date-slider">
                <!-- Generated by JS -->
            </div>
        </div>

        <!-- View Navigation -->
        <div class="tab-navigation">
            <button class="tab-button active" data-view="rooms-view">Dhomat</button>
            <button class="tab-button" data-view="daily-view">Rezervimet</button>
            <button class="tab-button" data-view="monthly-view">Kalendari</button>
        </div>

        <!-- Statistics Summary -->
        <div class="stats-summary">
            <div class="stats-card">
                <div class="stats-title">Dhoma Dopio</div>
                <div class="stats-value">5 <span class="stats-fraction">/ 5</span></div>
                <div class="progress-bar">
                    <div class="progress-value progress-dopio" style="width: 62.5%"></div>
                </div>
            </div>
            <div class="stats-card">
                <div class="stats-title">Dhoma Triple</div>
                <div class="stats-value">2 <span class="stats-fraction">/ 4</span></div>
                <div class="progress-bar">
                    <div class="progress-value progress-triple" style="width: 50%"></div>
                </div>
            </div>
            <div class="stats-card">
                <div class="stats-title">Suite</div>
                <div class="stats-value">1 <span class="stats-fraction">/ 3</span></div>
                <div class="progress-bar">
                    <div class="progress-value progress-suite" style="width: 33.3%"></div>
                </div>
            </div>
        </div>

        <!-- Room List View -->
        <div class="view-container active" id="rooms-view">
            <div class="room-list" id="room-list">
                <!-- Dopio Rooms -->
                <div class="room-category">
                    <div class="category-title">
                        <div class="category-marker marker-dopio"></div>
                        Dhoma Dopio
                    </div>
                    <div class="room-cards" id="dopio-rooms">
                        <!-- Will be populated by JS -->
                    </div>
                </div>

                <!-- Triple Rooms -->
                <div class="room-category">
                    <div class="category-title">
                        <div class="category-marker marker-triple"></div>
                        Dhoma Triple
                    </div>
                    <div class="room-cards" id="triple-rooms">
                        <!-- Will be populated by JS -->
                    </div>
                </div>

                <!-- Suite Rooms -->
                <div class="room-category">
                    <div class="category-title">
                        <div class="category-marker marker-suite"></div>
                        Suite
                    </div>
                    <div class="room-cards" id="suite-rooms">
                        <!-- Will be populated by JS -->
                    </div>
                </div>
            </div>
        </div>

        <!-- Daily Calendar View -->
        <div class="view-container" id="daily-view">
            <div class="daily-calendar" id="daily-calendar">
                <div class="bookings-section">
                    <h3 class="section-title">Rezervimet për <span id="selected-date-display">sot</span></h3>
                    <div id="daily-bookings">
                        <!-- Will be populated by JS -->
                    </div>
                </div>
                
                <div class="bookings-section">
                    <h3 class="section-title">Rezervimet e ardhshme</h3>
                    <div id="upcoming-bookings">
                        <!-- Will be populated by JS -->
                    </div>
                </div>
            </div>
        </div>

        <!-- Monthly Calendar View -->
        <div class="view-container" id="monthly-view">
            <div class="monthly-calendar">
                <table class="calendar-table">
                    <thead>
                        <tr id="calendar-header">
                            <th>Dhoma</th>
                            <!-- Days will be generated by JS -->
                        </tr>
                    </thead>
                    <tbody id="calendar-body">
                        <!-- Will be generated by JS -->
                    </tbody>
                </table>
            </div>
        </div>
    </div>

    <!-- Floating Action Button -->
    <button class="floating-btn" id="floating-add-btn">
        <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
            <line x1="12" y1="5" x2="12" y2="19"></line>
            <line x1="5" y1="12" x2="19" y2="12"></line>
        </svg>
    </button>

    <!-- Booking Modal -->
    <div class="modal" id="booking-modal">
        <div class="modal-content">
            <div class="modal-header">
                <h2 class="modal-title" id="modal-title">Shto Rezervim të Ri</h2>
            </div>
            <div class="modal-body">
                <form id="booking-form">
                    <div class="form-group">
                        <label class="form-label" for="room-type">Lloji i Dhomës:</label>
                        <select class="form-control" id="room-type" required>
                            <option value="">Zgjidhni llojin e dhomës</option>
                            <option value="dopio">Dhomë Dopio</option>
                            <option value="triple">Dhomë Tre Persona</option>
                            <option value="suite">Suite</option>
                        </select>
                    </div>
                    <div class="form-group">
                        <label class="form-label" for="room-number">Numri i Dhomës:</label>
                        <select class="form-control" id="room-number" required>
                            <option value="">Zgjidhni numrin e dhomës</option>
                        </select>
                    </div>
                    <div class="form-group">
                        <label class="form-label" for="client-name">Emri i Klientit:</label>
                        <input type="text" class="form-control" id="client-name" required>
                    </div>
                    <div class="form-group">
                        <label class="form-label" for="check-in">Data e Check-in:</label>
                        <input type="date" class="form-control" id="check-in" required>
                    </div>
                    <div class="form-group">
                        <label class="form-label" for="check-out">Data e Check-out:</label>
                        <input type="date" class="form-control" id="check-out" required>
                    </div>
                    <div class="form-group">
                        <label class="form-label" for="status">Statusi:</label>
                        <select class="form-control" id="status" required>
                            <option value="booked">E Rezervuar</option>
                            <option value="pending">Në Pritje</option>
                        </select>
                    </div>
                    <div class="form-group">
                        <label class="form-label" for="comments">Komente:</label>
                        <input type="text" class="form-control" id="comments">
                    </div>
                </form>
            </div>
            <div class="modal-footer">
                <button class="btn btn-secondary" id="cancel-booking">Anulo</button>
                <button class="btn btn-primary" id="save-booking">Ruaj</button>
            </div>
        </div>
    </div>

    <!-- Booking Details Modal -->
    <div class="modal" id="booking-details-modal">
        <div class="modal-content">
            <div class="modal-header">
                <h2 class="modal-title">Detaje të Rezervimit</h2>
            </div>
            <div class="modal-body">
                <div id="booking-details-content">
                    <!-- Will be populated by JS -->
                </div>
            </div>
            <div class="modal-footer">
                <button class="btn btn-danger" id="delete-booking">Fshij</button>
                <button class="btn btn-secondary" id="close-details">Mbyll</button>
                <button class="btn btn-primary" id="edit-booking">Ndrysho</button>
            </div>
        </div>
    </div>

    <!-- Toast Notification -->
    <div class="toast" id="toast-notification">Rezervimi u ruajt me sukses!</div>

    <!-- Loading Indicator -->
    <div class="loader" id="loader" style="display: none;">
        <div class="spinner"></div>
    </div>

    <script src="https://cdnjs.cloudflare.com/ajax/libs/xlsx/0.18.5/xlsx.full.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/sql.js/1.8.0/sql-wasm.js"></script>
    <script>
        // Të dhënat e dhomave me numrat e saktë (nga kodi origjinal)
        const roomData = {
            'dopio': ['1', '4', '5', '10', '11'],
            'triple': ['2', '3', '8', '9'],
            'suite': ['6', '7', '12']
        };

        // Variablat e përgjithshme
        let db = null;
        let bookings = [];
        let currentDate = new Date();
        let currentMonth = currentDate.getMonth();
        let currentYear = currentDate.getFullYear();
        let currentBooking = null;
        let selectedDate = new Date();
        selectedDate.setHours(0, 0, 0, 0);

        // Elementet e DOM
        const dateSlider = document.getElementById('date-slider');
        const currentMonthElement = document.getElementById('current-month');
        const selectedDateDisplay = document.getElementById('selected-date-display');
        const prevMonthButton = document.getElementById('prev-month');
        const nextMonthButton = document.getElementById('next-month');
        const addBookingButton = document.getElementById('add-booking-btn');
        const floatingAddButton = document.getElementById('floating-add-btn');
        const bookingModal = document.getElementById('booking-modal');
        const bookingForm = document.getElementById('booking-form');
        const modalTitle = document.getElementById('modal-title');
        const roomTypeSelect = document.getElementById('room-type');
        const roomNumberSelect = document.getElementById('room-number');
        const clientNameInput = document.getElementById('client-name');
        const checkInInput = document.getElementById('check-in');
        const checkOutInput = document.getElementById('check-out');
        const statusSelect = document.getElementById('status');
        const commentsInput = document.getElementById('comments');
        const cancelBookingButton = document.getElementById('cancel-booking');
        const saveBookingButton = document.getElementById('save-booking');
        const bookingDetailsModal = document.getElementById('booking-details-modal');
        const bookingDetailsContent = document.getElementById('booking-details-content');
        const closeDetailsButton = document.getElementById('close-details');
        const editBookingButton = document.getElementById('edit-booking');
        const deleteBookingButton = document.getElementById('delete-booking');
        const tabButtons = document.querySelectorAll('.tab-button');
        const viewContainers = document.querySelectorAll('.view-container');
        const dopioRoomsContainer = document.getElementById('dopio-rooms');
        const tripleRoomsContainer = document.getElementById('triple-rooms');
        const suiteRoomsContainer = document.getElementById('suite-rooms');
        const dailyBookingsContainer = document.getElementById('daily-bookings');
        const upcomingBookingsContainer = document.getElementById('upcoming-bookings');
        const calendarHeader = document.getElementById('calendar-header');
        const calendarBody = document.getElementById('calendar-body');
        const toastNotification = document.getElementById('toast-notification');
        const loader = document.getElementById('loader');

        // Tab Navigation
        tabButtons.forEach(button => {
            button.addEventListener('click', () => {
                const targetView = button.getAttribute('data-view');
                
                // Update active button
                tabButtons.forEach(btn => btn.classList.remove('active'));
                button.classList.add('active');
                
                // Show target view, hide others
                viewContainers.forEach(container => {
                    if (container.id === targetView) {
                        container.classList.add('active');
                    } else {
                        container.classList.remove('active');
                    }
                });
                
                // Refresh the specific view
                if (targetView === 'rooms-view') {
                    updateRoomListView();
                } else if (targetView === 'daily-view') {
                    updateDailyView();
                } else if (targetView === 'monthly-view') {
                    updateMonthlyCalendar();
                }
            });
        });

        // Inicializo datën e sotme në slider
        initializeDateSlider();

        // Funksion për të inicializuar date slider
        function initializeDateSlider() {
            dateSlider.innerHTML = '';
            
            const daysInMonth = new Date(currentYear, currentMonth + 1, 0).getDate();
            const monthNames = ['Janar', 'Shkurt', 'Mars', 'Prill', 'Maj', 'Qershor', 'Korrik', 'Gusht', 'Shtator', 'Tetor', 'Nëntor', 'Dhjetor'];
            const weekDayNames = ['H', 'M', 'M', 'E', 'P', 'S', 'D'];
            
            currentMonthElement.textContent = `${monthNames[currentMonth]} ${currentYear}`;
            
            for (let day = 1; day <= daysInMonth; day++) {
                const date = new Date(currentYear, currentMonth, day);
                date.setHours(0, 0, 0, 0);
                const dayOfWeek = date.getDay();
                // Konverto në indeksin tonë (0=E hënë, ..., 6=E diel)
                const weekDayIndex = dayOfWeek === 0 ? 6 : dayOfWeek - 1;
                const weekDay = weekDayNames[weekDayIndex];
                
                const isToday = date.getTime() === selectedDate.getTime();
                
                // Check if this date has any bookings
                const hasBookings = bookings.some(booking => {
                    const checkIn = new Date(booking.checkIn);
                    const checkOut = new Date(booking.checkOut);
                    checkIn.setHours(0, 0, 0, 0);
                    checkOut.setHours(0, 0, 0, 0);
                    return date >= checkIn && date < checkOut;
                });
                
                const dateItem = document.createElement('div');
                dateItem.className = `date-item ${isToday ? 'active' : ''} ${hasBookings ? 'has-bookings' : ''}`;
                dateItem.setAttribute('data-date', formatDate(date));
                dateItem.innerHTML = `
                    <div class="date-weekday">${weekDay}</div>
                    <div class="date-day">${day}</div>
                `;
                
                dateItem.addEventListener('click', function() {
                    document.querySelectorAll('.date-item').forEach(item => {
                        item.classList.remove('active');
                    });
                    this.classList.add('active');
                    selectedDate = new Date(this.getAttribute('data-date'));
                    selectedDate.setHours(0, 0, 0, 0);
                    updateSelectedDateDisplay();
                    
                    // Rifresko pamjet
                    updateRoomListView();
                    updateDailyView();
                    updateCalendarIndicators();
                });
                
                dateSlider.appendChild(dateItem);
            }
            
            // Scroll to selected date
            setTimeout(() => {
                const activeDate = document.querySelector('.date-item.active');
                if (activeDate) {
                    activeDate.scrollIntoView({ behavior: 'smooth', inline: 'center', block: 'nearest' });
                }
            }, 100);
            
            updateSelectedDateDisplay();
        }

        // Përditëso shfaqjen e datës së zgjedhur
        function updateSelectedDateDisplay() {
            const options = { weekday: 'long', year: 'numeric', month: 'long', day: 'numeric' };
            const formattedDate = selectedDate.toLocaleDateString('sq-AL', options);
            selectedDateDisplay.textContent = formattedDate;
        }

        // Funksion për të inicializuar bazën e të dhënave SQLite
        async function initializeDatabase() {
            try {
                showLoader();
                
                // Inicializo SQL.js
                const SQL = await initSqlJs({
                    locateFile: file => `https://cdnjs.cloudflare.com/ajax/libs/sql.js/1.8.0/${file}`
                });
                
                // Kontrollo nëse ekziston një bazë e të dhënave në localStorage
                const savedDbData = localStorage.getItem('hotelBookingDb');
                
                if (savedDbData) {
                    // Ngarko bazën e të dhënave nga localStorage
                    const dbData = new Uint8Array(JSON.parse(savedDbData));
                    db = new SQL.Database(dbData);
                    showToast("Baza e të dhënave u ngarkua me sukses");
                } else {
                    // Krijo një bazë të dhënash të re
                    db = new SQL.Database();
                    
                    // Krijo tabelën e rezervimeve
                    db.run(`
                        CREATE TABLE IF NOT EXISTS bookings (
                            id TEXT PRIMARY KEY,
                            roomType TEXT NOT NULL,
                            roomNumber TEXT NOT NULL,
                            clientName TEXT NOT NULL,
                            checkIn TEXT NOT NULL,
                            checkOut TEXT NOT NULL,
                            status TEXT NOT NULL,
                            comments TEXT,
                            createdAt TEXT NOT NULL,
                            updatedAt TEXT NOT NULL
                        )
                    `);
                    
                    // Shto disa të dhëna demo nëse është baza e re
                    addDemoData();
                    
                    showToast("U krijua një bazë e re e të dhënave");
                }
                
                // Lexo të gjitha rezervimet nga baza e të dhënave
                loadBookingsFromDatabase();
                hideLoader();
                
                // Përditëso të gjitha pamjet
                updateRoomListView();
                updateDailyView();
                updateMonthlyCalendar();
                
            } catch (error) {
                console.error('Gabim gjatë inicializimit të bazës së të dhënave:', error);
                hideLoader();
                showToast("Gabim gjatë inicializimit të bazës së të dhënave", true);
                
                // Si plan rezervë, përdor localStorage
                alert('Ka ndodhur një gabim me bazën e të dhënave. Duke përdorur localStorage si plan rezervë.');
                loadBackupData();
            }
        }

        // Funksion për të shtuar të dhëna demo
        function addDemoData() {
            const now = new Date().toISOString();
            const today = new Date();
            today.setHours(0, 0, 0, 0);
            
            // Krijo disa rezervime demo
            const demoBookings = [
                {
                    id: '1001',
                    roomType: 'dopio',
                    roomNumber: '1',
                    clientName: 'Artan Kelmendi',
                    checkIn: formatDate(today),
                    checkOut: formatDate(new Date(today.getTime() + 3 * 24 * 60 * 60 * 1000)),
                    status: 'booked',
                    comments: 'Prenotim për vikend',
                    createdAt: now,
                    updatedAt: now
                },
                {
                    id: '1002',
                    roomType: 'triple',
                    roomNumber: '3',
                    clientName: 'Besa Haxhiu',
                    checkIn: formatDate(new Date(today.getTime() + 2 * 24 * 60 * 60 * 1000)),
                    checkOut: formatDate(new Date(today.getTime() + 5 * 24 * 60 * 60 * 1000)),
                    status: 'pending',
                    comments: 'Familje me fëmijë',
                    createdAt: now,
                    updatedAt: now
                },
                {
                    id: '1003',
                    roomType: 'suite',
                    roomNumber: '7',
                    clientName: 'Drilon Berisha',
                    checkIn: formatDate(new Date(today.getTime() + 7 * 24 * 60 * 60 * 1000)),
                    checkOut: formatDate(new Date(today.getTime() + 10 * 24 * 60 * 60 * 1000)),
                    status: 'booked',
                    comments: 'Ditëlindje speciale',
                    createdAt: now,
                    updatedAt: now
                }
            ];
            
            // Shto rezervimet demo në bazën e të dhënave
            demoBookings.forEach(booking => {
                db.run(`
                    INSERT INTO bookings (
                        id, roomType, roomNumber, clientName, 
                        checkIn, checkOut, status, comments,
                        createdAt, updatedAt
                    ) VALUES (?, ?, ?, ?, ?, ?, ?, ?, ?, ?)
                `, [
                    booking.id,
                    booking.roomType,
                    booking.roomNumber,
                    booking.clientName,
                    booking.checkIn,
                    booking.checkOut,
                    booking.status,
                    booking.comments,
                    booking.createdAt,
                    booking.updatedAt
                ]);
            });
            
            saveDatabase();
        }

        // Funksion për të ngarkuar rezervimet nga baza e të dhënave
        function loadBookingsFromDatabase() {
            if (!db) return;
            
            try {
                const result = db.exec("SELECT * FROM bookings");
                
                if (result.length > 0 && result[0].values.length > 0) {
                    bookings = result[0].values.map(row => {
                        const columns = result[0].columns;
                        const booking = {};
                        
                        columns.forEach((column, index) => {
                            booking[column] = row[index];
                        });
                        
                        return booking;
                    });
                    
                    updateBookingStats();
                } else {
                    bookings = [];
                    updateBookingStats();
                }
                
                // Mark dates with bookings in the date slider
                updateCalendarIndicators();
            } catch (error) {
                console.error('Gabim gjatë ngarkimit të rezervimeve:', error);
                showToast("Gabim gjatë ngarkimit të rezervimeve", true);
            }
        }

        // Update calendar indicators for dates with bookings
        function updateCalendarIndicators() {
            // First reset all indicators
            document.querySelectorAll('.date-item').forEach(item => {
                item.classList.remove('has-bookings');
            });
            
            // Then mark dates with bookings
            bookings.forEach(booking => {
                const checkIn = new Date(booking.checkIn);
                const checkOut = new Date(booking.checkOut);
                checkIn.setHours(0, 0, 0, 0);
                checkOut.setHours(0, 0, 0, 0);
                
                const currentDate = new Date(currentYear, currentMonth, 1);
                const lastDay = new Date(currentYear, currentMonth + 1, 0).getDate();
                
                for (let day = 1; day <= lastDay; day++) {
                    currentDate.setDate(day);
                    
                    if (currentDate >= checkIn && currentDate < checkOut) {
                        const dateStr = formatDate(currentDate);
                        const dateItem = document.querySelector(`.date-item[data-date="${dateStr}"]`);
                        if (dateItem) {
                            dateItem.classList.add('has-bookings');
                        }
                    }
                }
            });
        }

        // Funksion për të përditësuar statistikat e rezervimeve
        function updateBookingStats() {
            // Numëro rezervimet aktive
            const activeBookings = bookings.filter(booking => {
                const checkOut = new Date(booking.checkOut);
                return checkOut >= new Date();
            }).length;
            
            // Përditëso në UI
            document.querySelector('.header-stats').textContent = `${activeBookings} rezervime aktive`;
            
            // Llogarit dhe përditëso statistikat për çdo lloj dhome
            const stats = {
                dopio: { booked: 0, total: roomData.dopio.length },
                triple: { booked: 0, total: roomData.triple.length },
                suite: { booked: 0, total: roomData.suite.length }
            };
            
            // Numëro dhomat e zëna për datën e zgjedhur
            bookings.forEach(booking => {
                const checkIn = new Date(booking.checkIn);
                const checkOut = new Date(booking.checkOut);
                
                if (selectedDate >= checkIn && selectedDate < checkOut) {
                    stats[booking.roomType].booked++;
                }
            });
            
            // Përditëso kartat e statistikave
            const statsCards = document.querySelectorAll('.stats-card');
            
            if (statsCards.length === 3) {
                // Dopio Stats
                statsCards[0].querySelector('.stats-value').innerHTML = 
                    `${stats.dopio.booked} <span class="stats-fraction">/ ${stats.dopio.total}</span>`;
                statsCards[0].querySelector('.progress-value').style.width = 
                    `${(stats.dopio.booked / stats.dopio.total) * 100}%`;
                
                // Triple Stats
                statsCards[1].querySelector('.stats-value').innerHTML = 
                    `${stats.triple.booked} <span class="stats-fraction">/ ${stats.triple.total}</span>`;
                statsCards[1].querySelector('.progress-value').style.width = 
                    `${(stats.triple.booked / stats.triple.total) * 100}%`;
                
                // Suite Stats
                statsCards[2].querySelector('.stats-value').innerHTML = 
                    `${stats.suite.booked} <span class="stats-fraction">/ ${stats.suite.total}</span>`;
                statsCards[2].querySelector('.progress-value').style.width = 
                    `${(stats.suite.booked / stats.suite.total) * 100}%`;
            }
        }

        // Funksion për të ruajtur bazën e të dhënave në localStorage
        function saveDatabase() {
            if (!db) return;
            
            try {
                const data = db.export();
                const arrayBuffer = new Uint8Array(data);
                localStorage.setItem('hotelBookingDb', JSON.stringify(Array.from(arrayBuffer)));
                localStorage.setItem('lastSavedTime', new Date().toISOString());
                return true;
            } catch (error) {
                console.error('Gabim gjatë ruajtjes së bazës së të dhënave:', error);
                return false;
            }
        }

        // Funksion për të ngarkuar të dhënat nga localStorage (si plan rezervë)
        function loadBackupData() {
            const savedBookings = localStorage.getItem('hotelBookings');
            if (savedBookings) {
                bookings = JSON.parse(savedBookings);
                updateBookingStats();
                
                // Rifresko të gjitha pamjet
                updateRoomListView();
                updateDailyView();
                updateMonthlyCalendar();
            }
        }

        // Funksion për të përditësuar pamjen e listës së dhomave
        function updateRoomListView() {
            const dopioHTML = generateRoomCardsByType('dopio');
            const tripleHTML = generateRoomCardsByType('triple');
            const suiteHTML = generateRoomCardsByType('suite');
            
            dopioRoomsContainer.innerHTML = dopioHTML;
            tripleRoomsContainer.innerHTML = tripleHTML;
            suiteRoomsContainer.innerHTML = suiteHTML;
            
            // Add event listeners to room cards
            document.querySelectorAll('.room-card').forEach(card => {
                card.addEventListener('click', function() {
                    const roomType = this.getAttribute('data-room-type');
                    const roomNumber = this.getAttribute('data-room-number');
                    const bookingId = this.getAttribute('data-booking-id');
                    
                    if (bookingId) {
                        // Show booking details if room is booked
                        showBookingDetails(bookingId);
                    } else {
                        // Show add booking modal for the selected room if available
                        showAddBookingModalForRoom(roomType, roomNumber);
                    }
                });
            });
        }

        // Generate room cards by room type
        function generateRoomCardsByType(roomType) {
            let html = '';
            
            roomData[roomType].forEach(roomNumber => {
                // Check if room is booked for the selected date
                const booking = getBookingForRoom(roomType, roomNumber, selectedDate);
                const isBooked = booking !== null;
                
                let statusClass = 'room-status-available';
                let statusText = 'E Disponueshme';
                let clientInfo = '';
                let bookingDates = '';
                let bookingId = '';
                
                if (isBooked) {
                    statusClass = `room-status-${booking.status}`;
                    statusText = translateStatus(booking.status);
                    clientInfo = booking.clientName;
                    
                    const checkIn = new Date(booking.checkIn);
                    const checkOut = new Date(booking.checkOut);
                    const nights = Math.round((checkOut - checkIn) / (1000 * 60 * 60 * 24));
                    
                    bookingDates = `${formatDateForDisplay(booking.checkIn)} - ${formatDateForDisplay(booking.checkOut)} (${nights} netë)`;
                    bookingId = booking.id;
                }
                
                html += `
                    <div class="room-card room-card-${roomType}" data-room-type="${roomType}" data-room-number="${roomNumber}" data-booking-id="${bookingId}">
                        <div class="room-status ${statusClass}">${statusText}</div>
                        <div class="room-title">${translateRoomType(roomType)} ${roomNumber}</div>
                        ${isBooked ? `
                            <div class="room-client">${clientInfo}</div>
                            <div class="room-details">${bookingDates}</div>
                        ` : `
                            <div class="room-details">Kliko për të shtuar një rezervim</div>
                        `}
                    </div>
                `;
            });
            
            return html;
        }

        // Funksion për të përditësuar pamjen ditore
        function updateDailyView() {
            // Filter bookings for the selected date
            const todayBookings = bookings.filter(booking => {
                const checkIn = new Date(booking.checkIn);
                const checkOut = new Date(booking.checkOut);
                checkIn.setHours(0, 0, 0, 0);
                checkOut.setHours(0, 0, 0, 0);
                
                return selectedDate >= checkIn && selectedDate < checkOut;
            });
            
            // Filter upcoming bookings (future check-ins)
            const futureBookings = bookings.filter(booking => {
                const checkIn = new Date(booking.checkIn);
                checkIn.setHours(0, 0, 0, 0);
                
                return checkIn > selectedDate;
            }).sort((a, b) => new Date(a.checkIn) - new Date(b.checkIn)).slice(0, 5); // Show only 5 upcoming
            
            // Generate HTML for today's bookings
            if (todayBookings.length > 0) {
                let html = '';
                todayBookings.forEach(booking => {
                    html += generateBookingCardHTML(booking);
                });
                dailyBookingsContainer.innerHTML = html;
            } else {
                dailyBookingsContainer.innerHTML = `
                    <div class="empty-state">
                        <div class="empty-icon">📅</div>
                        <div class="empty-title">Nuk ka rezervime për këtë datë</div>
                        <div class="empty-description">Asnjë dhomë nuk është rezervuar për datën e zgjedhur</div>
                    </div>
                `;
            }
            
            // Generate HTML for upcoming bookings
            if (futureBookings.length > 0) {
                let html = '';
                futureBookings.forEach(booking => {
                    html += generateBookingCardHTML(booking);
                });
                upcomingBookingsContainer.innerHTML = html;
            } else {
                upcomingBookingsContainer.innerHTML = `
                    <div class="empty-state">
                        <div class="empty-icon">🔮</div>
                        <div class="empty-title">Nuk ka rezervime të ardhshme</div>
                        <div class="empty-description">Nuk ka rezervime të planifikuara për datat në vijim</div>
                    </div>
                `;
            }
            
            // Add event listeners to booking cards
            document.querySelectorAll('.booking-card[data-booking-id]').forEach(card => {
                card.addEventListener('click', function() {
                    const bookingId = this.getAttribute('data-booking-id');
                    showBookingDetails(bookingId);
                });
            });
        }

        // Generate booking card HTML
        function generateBookingCardHTML(booking) {
            const checkIn = new Date(booking.checkIn);
            const checkOut = new Date(booking.checkOut);
            const nights = Math.round((checkOut - checkIn) / (1000 * 60 * 60 * 24));
            
            return `
                <div class="booking-card" data-booking-id="${booking.id}">
                    <div class="booking-content border-${booking.roomType}">
                        <div class="booking-header">
                            <div>
                                <div class="booking-room">${translateRoomType(booking.roomType)} ${booking.roomNumber}</div>
                                <div class="booking-client">${booking.clientName}</div>
                            </div>
                            <div class="booking-status status-${booking.status}">${translateStatus(booking.status)}</div>
                        </div>
                        <div class="booking-date">${formatDateForDisplay(booking.checkIn)} - ${formatDateForDisplay(booking.checkOut)} (${nights} netë)</div>
                    </div>
                </div>
            `;
        }

        // Funksion për të përditësuar kalendarin mujor
        function updateMonthlyCalendar() {
            // Generate header with days of the month
            calendarHeader.innerHTML = '<th>Dhoma</th>';
            
            const daysInMonth = new Date(currentYear, currentMonth + 1, 0).getDate();
            for (let day = 1; day <= daysInMonth; day++) {
                const date = new Date(currentYear, currentMonth, day);
                const isWeekend = date.getDay() === 0 || date.getDay() === 6;
                const isSelected = date.getDate() === selectedDate.getDate() && 
                                  date.getMonth() === selectedDate.getMonth() && 
                                  date.getFullYear() === selectedDate.getFullYear();
                
                const th = document.createElement('th');
                th.textContent = day;
                if (isWeekend) th.classList.add('weekend');
                if (isSelected) th.classList.add('selected-date');
                calendarHeader.appendChild(th);
            }
            
            // Generate rows for each room
            calendarBody.innerHTML = '';
            
            // Add Dopio rooms
            roomData.dopio.forEach(roomNumber => {
                const row = document.createElement('tr');
                const cell = document.createElement('td');
                cell.textContent = `Dhomë Dopio ${roomNumber}`;
                row.appendChild(cell);
                
                // Add cells for each day
                for (let day = 1; day <= daysInMonth; day++) {
                    const date = new Date(currentYear, currentMonth, day);
                    const booking = getBookingForRoom('dopio', roomNumber, date);
                    
                    const td = document.createElement('td');
                    td.className = `calendar-cell cell-${booking ? booking.status : 'available'} cell-dopio`;
                    if (booking) {
                        td.textContent = booking.clientName.split(' ')[0];
                        td.setAttribute('data-booking-id', booking.id);
                        
                        td.addEventListener('click', () => {
                            showBookingDetails(booking.id);
                        });
                    } else {
                        td.addEventListener('click', () => {
                            const clickedDate = new Date(currentYear, currentMonth, day);
                            showAddBookingModalForRoom('dopio', roomNumber, clickedDate);
                        });
                    }
                    
                    row.appendChild(td);
                }
                
                calendarBody.appendChild(row);
            });
            
            // Add Triple rooms
            roomData.triple.forEach(roomNumber => {
                const row = document.createElement('tr');
                const cell = document.createElement('td');
                cell.textContent = `Dhomë Triple ${roomNumber}`;
                row.appendChild(cell);
                
                // Add cells for each day
                for (let day = 1; day <= daysInMonth; day++) {
                    const date = new Date(currentYear, currentMonth, day);
                    const booking = getBookingForRoom('triple', roomNumber, date);
                    
                    const td = document.createElement('td');
                    td.className = `calendar-cell cell-${booking ? booking.status : 'available'} cell-triple`;
                    if (booking) {
                        td.textContent = booking.clientName.split(' ')[0];
                        td.setAttribute('data-booking-id', booking.id);
                        
                        td.addEventListener('click', () => {
                            showBookingDetails(booking.id);
                        });
                    } else {
                        td.addEventListener('click', () => {
                            const clickedDate = new Date(currentYear, currentMonth, day);
                            showAddBookingModalForRoom('triple', roomNumber, clickedDate);
                        });
                    }
                    
                    row.appendChild(td);
                }
                
                calendarBody.appendChild(row);
            });
            
            // Add Suite rooms
            roomData.suite.forEach(roomNumber => {
                const row = document.createElement('tr');
                const cell = document.createElement('td');
                cell.textContent = `Suite ${roomNumber}`;
                row.appendChild(cell);
                
                // Add cells for each day
                for (let day = 1; day <= daysInMonth; day++) {
                    const date = new Date(currentYear, currentMonth, day);
                    const booking = getBookingForRoom('suite', roomNumber, date);
                    
                    const td = document.createElement('td');
                    td.className = `calendar-cell cell-${booking ? booking.status : 'available'} cell-suite`;
                    if (booking) {
                        td.textContent = booking.clientName.split(' ')[0];
                        td.setAttribute('data-booking-id', booking.id);
                        
                        td.addEventListener('click', () => {
                            showBookingDetails(booking.id);
                        });
                    } else {
                        td.addEventListener('click', () => {
                            const clickedDate = new Date(currentYear, currentMonth, day);
                            showAddBookingModalForRoom('suite', roomNumber, clickedDate);
                        });
                    }
                    
                    row.appendChild(td);
                }
                
                calendarBody.appendChild(row);
            });
        }

        // Get booking for a specific room and date
        function getBookingForRoom(roomType, roomNumber, date) {
            return bookings.find(booking => {
                const checkIn = new Date(booking.checkIn);
                const checkOut = new Date(booking.checkOut);
                
                checkIn.setHours(0, 0, 0, 0);
                checkOut.setHours(0, 0, 0, 0);
                date.setHours(0, 0, 0, 0);
                
                return booking.roomType === roomType && 
                       booking.roomNumber === roomNumber && 
                       date >= checkIn && date < checkOut;
            }) || null;
        }

        // Funksion për të formatuar një datë në formatin YYYY-MM-DD
        function formatDate(date) {
            const year = date.getFullYear();
            const month = String(date.getMonth() + 1).padStart(2, '0');
            const day = String(date.getDate()).padStart(2, '0');
            return `${year}-${month}-${day}`;
        }

        // Funksion për të formatuar një datë për shfaqje
        function formatDateForDisplay(dateString) {
            const date = new Date(dateString);
            return `${date.getDate()} ${getMonthShortName(date.getMonth())}`;
        }

        // Funksion për të marrë emrin e shkurtër të muajit
        function getMonthShortName(monthIndex) {
            const monthNames = ['Jan', 'Shk', 'Mar', 'Pri', 'Maj', 'Qer', 'Kor', 'Gus', 'Sht', 'Tet', 'Nën', 'Dhj'];
            return monthNames[monthIndex];
        }

        // Funksion për të përditësuar përzgjedhësin e numrit të dhomës bazuar në llojin e dhomës
        roomTypeSelect.addEventListener('change', updateRoomNumbers);

        function updateRoomNumbers() {
            const roomType = roomTypeSelect.value;
            roomNumberSelect.innerHTML = '<option value="">Zgjidhni numrin e dhomës</option>';
            
            if (roomType) {
                roomData[roomType].forEach(room => {
                    const option = document.createElement('option');
                    option.value = room;
                    option.textContent = room;
                    roomNumberSelect.appendChild(option);
                });
            }
        }

        // Funksion për të shfaqur modalin e shtimit të rezervimit
        function showAddBookingModal() {
            modalTitle.textContent = 'Shto Rezervim të Ri';
            bookingForm.reset();
            
            // Vendos datën e zgjedhur për check-in
            checkInInput.value = formatDate(selectedDate);
            
            // Vendos datën e daljes paraprakisht një ditë pas
            const checkOutDate = new Date(selectedDate);
            checkOutDate.setDate(checkOutDate.getDate() + 1);
            checkOutInput.value = formatDate(checkOutDate);
            
            currentBooking = null;
            bookingModal.style.display = 'block';
        }

        // Funksion për të shfaqur modalin e shtimit të rezervimit për një dhomë specifike
        function showAddBookingModalForRoom(roomType, roomNumber, date = null) {
            modalTitle.textContent = 'Shto Rezervim të Ri';
            bookingForm.reset();
            
            // Vendos llojin e dhomës
            roomTypeSelect.value = roomType;
            updateRoomNumbers();
            
            // Vendos numrin e dhomës
            roomNumberSelect.value = roomNumber;
            
            // Vendos datën e check-in
            const checkInDate = date || selectedDate;
            checkInInput.value = formatDate(checkInDate);
            
            // Vendos datën e daljes paraprakisht një ditë pas
            const checkOutDate = new Date(checkInDate);
            checkOutDate.setDate(checkOutDate.getDate() + 1);
            checkOutInput.value = formatDate(checkOutDate);
            
            currentBooking = null;
            bookingModal.style.display = 'block';
        }

        // Funksion për të shfaqur detajet e rezervimit
        function showBookingDetails(bookingId) {
            currentBooking = bookings.find(b => b.id === bookingId);
            
            if (currentBooking) {
                const checkIn = new Date(currentBooking.checkIn);
                const checkOut = new Date(currentBooking.checkOut);
                const nights = Math.round((checkOut - checkIn) / (1000 * 60 * 60 * 24));
                const createdDate = currentBooking.createdAt ? new Date(currentBooking.createdAt).toLocaleString('sq-AL') : 'E panjohur';
                const updatedDate = currentBooking.updatedAt ? new Date(currentBooking.updatedAt).toLocaleString('sq-AL') : 'E panjohur';
                
                const details = `
                    <div class="booking-details-panel">
                        <div class="details-header">
                            <div class="details-title">${translateRoomType(currentBooking.roomType)} ${currentBooking.roomNumber}</div>
                            <div class="details-status status-${currentBooking.status}">${translateStatus(currentBooking.status)}</div>
                        </div>
                        
                        <div class="details-info">
                            <div class="details-label">Emri i Klientit:</div>
                            <div class="details-value">${currentBooking.clientName}</div>
                            
                            <div class="details-label">Check-in:</div>
                            <div class="details-value">${formatDateForDisplay(currentBooking.checkIn)} ${checkIn.getFullYear()}</div>
                            
                            <div class="details-label">Check-out:</div>
                            <div class="details-value">${formatDateForDisplay(currentBooking.checkOut)} ${checkOut.getFullYear()}</div>
                            
                            <div class="details-label">Netë:</div>
                            <div class="details-value">${nights}</div>
                            
                            <div class="details-label">Komente:</div>
                            <div class="details-value">${currentBooking.comments || 'Asnjë'}</div>
                            
                            <div class="details-label">Krijuar më:</div>
                            <div class="details-value">${createdDate}</div>
                            
                            <div class="details-label">Përditësuar më:</div>
                            <div class="details-value">${updatedDate}</div>
                        </div>
                    </div>
                `;
                
                bookingDetailsContent.innerHTML = details;
                bookingDetailsModal.style.display = 'block';
            }
        }

        // Funksion për të shfaqur modalin e ndryshimit të rezervimit
        function showEditBookingModal() {
            if (currentBooking) {
                modalTitle.textContent = 'Ndrysho Rezervimin';
                
                roomTypeSelect.value = currentBooking.roomType;
                updateRoomNumbers();
                roomNumberSelect.value = currentBooking.roomNumber;
                clientNameInput.value = currentBooking.clientName;
                checkInInput.value = currentBooking.checkIn;
                checkOutInput.value = currentBooking.checkOut;
                statusSelect.value = currentBooking.status;
                commentsInput.value = currentBooking.comments || '';
                
                bookingDetailsModal.style.display = 'none';
                bookingModal.style.display = 'block';
            }
        }

        // Funksion për të fshirë një rezervim
        function deleteBooking() {
            if (currentBooking && confirm('A jeni të sigurt që dëshironi të fshini këtë rezervim?')) {
                showLoader();
                
                if (deleteBookingFromDatabase(currentBooking.id)) {
                    bookings = bookings.filter(b => b.id !== currentBooking.id);
                    updateBookingStats();
                    
                    // Rifresko të gjitha pamjet
                    updateRoomListView();
                    updateDailyView();
                    updateMonthlyCalendar();
                    updateCalendarIndicators();
                    
                    bookingDetailsModal.style.display = 'none';
                    showToast('Rezervimi u fshi me sukses!');
                } else {
                    showToast('Ndodhi një gabim gjatë fshirjes së rezervimit.', true);
                }
                
                hideLoader();
            }
        }

        // Funksion për të fshirë një rezervim nga baza e të dhënave
        function deleteBookingFromDatabase(bookingId) {
            if (!db) return false;
            
            try {
                db.run(`DELETE FROM bookings WHERE id = ?`, [bookingId]);
                saveDatabase();
                return true;
            } catch (error) {
                console.error('Gabim gjatë fshirjes së rezervimit:', error);
                return false;
            }
        }

        // Funksion për të ruajtur një rezervim të ri ose të ndryshuar
        function saveBooking() {
            const roomType = roomTypeSelect.value;
            const roomNumber = roomNumberSelect.value;
            const clientName = clientNameInput.value;
            const checkIn = checkInInput.value;
            const checkOut = checkOutInput.value;
            const status = statusSelect.value;
            const comments = commentsInput.value;
            
            if (!roomType || !roomNumber || !clientName || !checkIn || !checkOut) {
                alert('Ju lutemi plotësoni të gjitha fushat e kërkuara');
                return;
            }
            
            if (new Date(checkOut) <= new Date(checkIn)) {
                alert('Data e check-out duhet të jetë pas datës së check-in');
                return;
            }
            
            // Kontrollo nëse dhoma është e disponueshme për datat e zgjedhura
            if (!isRoomAvailable(roomType, roomNumber, checkIn, checkOut, currentBooking?.id)) {
                alert('Dhoma është e rezervuar për periudhën e zgjedhur');
                return;
            }
            
            showLoader();
            
            let newBooking;
            
            if (currentBooking) {
                // Ndrysho rezervimin ekzistues
                Object.assign(currentBooking, {
                    roomType,
                    roomNumber,
                    clientName,
                    checkIn,
                    checkOut,
                    status,
                    comments
                });
                
                newBooking = currentBooking;
            } else {
                // Krijo një rezervim të ri
                newBooking = {
                    id: Date.now().toString(),
                    roomType,
                    roomNumber,
                    clientName,
                    checkIn,
                    checkOut,
                    status,
                    comments
                };
                
                bookings.push(newBooking);
            }
            
            // Ruaj në bazën e të dhënave
            if (saveBookingToDatabase(newBooking)) {
                updateBookingStats();
                
                // Rifresko të gjitha pamjet
                updateRoomListView();
                updateDailyView();
                updateMonthlyCalendar();
                updateCalendarIndicators();
                
                bookingModal.style.display = 'none';
                showToast('Rezervimi u ruajt me sukses!');
            } else {
                showToast('Ndodhi një gabim gjatë ruajtjes së rezervimit.', true);
            }
            
            hideLoader();
        }

        // Funksion për të ruajtur një rezervim në bazën e të dhënave
        function saveBookingToDatabase(booking) {
            if (!db) return false;
            
            try {
                const now = new Date().toISOString();
                
                // Kontrollo nëse rezervimi ekziston tashmë
                const exists = db.exec(`SELECT id FROM bookings WHERE id = '${booking.id}'`);
                
                if (exists.length > 0 && exists[0].values.length > 0) {
                    // Përditëso rezervimin ekzistues
                    db.run(`
                        UPDATE bookings SET
                            roomType = ?,
                            roomNumber = ?,
                            clientName = ?,
                            checkIn = ?,
                            checkOut = ?,
                            status = ?,
                            comments = ?,
                            updatedAt = ?
                        WHERE id = ?
                    `, [
                        booking.roomType,
                        booking.roomNumber,
                        booking.clientName,
                        booking.checkIn,
                        booking.checkOut,
                        booking.status,
                        booking.comments || '',
                        now,
                        booking.id
                    ]);
                } else {
                    // Shto një rezervim të ri
                    db.run(`
                        INSERT INTO bookings (
                            id, roomType, roomNumber, clientName, 
                            checkIn, checkOut, status, comments,
                            createdAt, updatedAt
                        ) VALUES (?, ?, ?, ?, ?, ?, ?, ?, ?, ?)
                    `, [
                        booking.id,
                        booking.roomType,
                        booking.roomNumber,
                        booking.clientName,
                        booking.checkIn,
                        booking.checkOut,
                        booking.status,
                        booking.comments || '',
                        now,
                        now
                    ]);
                }
                
                // Ruaj bazën e të dhënave në localStorage
                saveDatabase();
                return true;
            } catch (error) {
                console.error('Gabim gjatë ruajtjes së rezervimit:', error);
                return false;
            }
        }

        // Funksion për të kontrolluar nëse dhoma është e disponueshme
        function isRoomAvailable(roomType, roomNumber, checkIn, checkOut, excludeBookingId = null) {
            const start = new Date(checkIn);
            const end = new Date(checkOut);
            
            return !bookings.some(booking => {
                if (excludeBookingId && booking.id === excludeBookingId) {
                    return false;
                }
                
                if (booking.roomType !== roomType || booking.roomNumber !== roomNumber) {
                    return false;
                }
                
                const bookingStart = new Date(booking.checkIn);
                const bookingEnd = new Date(booking.checkOut);
                
                return (start < bookingEnd && end > bookingStart);
            });
        }

        // Funksione ndihmëse për përkthim
        function translateRoomType(type) {
            const translations = {
                'dopio': 'Dhomë Dopio',
                'triple': 'Dhomë Tre Persona',
                'suite': 'Suite'
            };
            return translations[type] || type;
        }

        function translateStatus(status) {
            const translations = {
                'booked': 'E Rezervuar',
                'pending': 'Në Pritje',
                'available': 'E Disponueshme'
            };
            return translations[status] || status;
        }

        // Funksion për të shfaqur një njoftim toast
        function showToast(message, isError = false) {
            toastNotification.textContent = message;
            toastNotification.style.backgroundColor = isError ? 'var(--error-color)' : 'var(--success-color)';
            toastNotification.classList.add('show');
            
            setTimeout(() => {
                toastNotification.classList.remove('show');
            }, 3000);
        }
// Funksion për të shfaqur spinner loading
        function showLoader() {
            loader.style.display = 'flex';
        }

        // Funksion për të fshehur spinner loading
        function hideLoader() {
            loader.style.display = 'none';
        }

        // Event Listeners
        prevMonthButton.addEventListener('click', function() {
            currentMonth--;
            if (currentMonth < 0) {
                currentMonth = 11;
                currentYear--;
            }
            initializeDateSlider();
            updateMonthlyCalendar();
            updateCalendarIndicators();
        });

        nextMonthButton.addEventListener('click', function() {
            currentMonth++;
            if (currentMonth > 11) {
                currentMonth = 0;
                currentYear++;
            }
            initializeDateSlider();
            updateMonthlyCalendar();
            updateCalendarIndicators();
        });

        addBookingButton.addEventListener('click', showAddBookingModal);
        floatingAddButton.addEventListener('click', showAddBookingModal);

        cancelBookingButton.addEventListener('click', function() {
            bookingModal.style.display = 'none';
        });

        saveBookingButton.addEventListener('click', function(e) {
            e.preventDefault();
            saveBooking();
        });

        closeDetailsButton.addEventListener('click', function() {
            bookingDetailsModal.style.display = 'none';
        });

        editBookingButton.addEventListener('click', showEditBookingModal);

        deleteBookingButton.addEventListener('click', deleteBooking);

        // Mbyll modalet kur klikohet jashtë tyre
        window.addEventListener('click', function(event) {
            if (event.target === bookingModal) {
                bookingModal.style.display = 'none';
            }
            if (event.target === bookingDetailsModal) {
                bookingDetailsModal.style.display = 'none';
            }
        });

        // Inicializo bazën e të dhënave
        initializeDatabase();
    </script>
</body>
</html>

